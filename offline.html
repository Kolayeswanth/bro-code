<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Generator - Offline Mode</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <div class="navbar-content">
            <a href="/" class="navbar-brand">
                <i class="fas fa-certificate"></i>
                Certificate Generator
            </a>
            <ul class="navbar-nav">
                <li><a href="/" class="nav-link btn-primary">
                    <i class="fas fa-sync-alt"></i>
                    Try to Reconnect
                </a></li>
            </ul>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section">
        <div class="hero-content">
            <h1><i class="fas fa-certificate"></i> Certificate Generator - Offline Mode</h1>
            <p>Currently running in offline mode. Database features are unavailable, but you can still generate certificates using CSV files.</p>
            
            <div style="background: rgba(255, 243, 205, 0.2); color: #856404; padding: 20px; margin: 30px 0; border-radius: 15px; border: 1px solid rgba(255, 234, 167, 0.3);">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Note:</strong> Running in offline mode. Database features are unavailable.
                <a href="/" style="color: #856404; text-decoration: underline; margin-left: 10px;">
                    Try to reconnect
                </a>
            </div>
            
            <div class="hero-features">
                <div class="feature-card">
                    <i class="fas fa-upload"></i>
                    <h3>CSV Upload Available</h3>
                    <p>Upload participant data via CSV files</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-palette"></i>
                    <h3>All Templates Available</h3>
                    <p>Access to all certificate templates</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-download"></i>
                    <h3>Download Ready</h3>
                    <p>Generate and download certificates instantly</p>
                </div>
            </div>

            <a href="#certificate-generator" class="cta-button" onclick="scrollToGenerator()">
                <i class="fas fa-magic"></i>
                Generate Certificates (Offline)
            </a>
        </div>
    </section>

    <!-- Certificate Generator Section -->
    <div id="certificate-generator" class="container">
        <header>
            <h1><i class="fas fa-certificate"></i> Certificate Generator - Offline Mode</h1>
            <p>Generate certificates without database connectivity</p>
        </header>

        <!-- Step 1: CSV Upload -->
        <div class="step active" id="step1">
            <div class="step-header">
                <h2><span class="step-number">1</span> Upload Participant Data</h2>
            </div>
            <div class="step-content">
                <div class="upload-section">
                    <div class="upload-area" id="uploadArea">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Drop your CSV file here or click to browse</h3>
                        <p>Upload a CSV file with participant names and details</p>
                        <input type="file" id="csvFile" accept=".csv" style="display: none;">
                    </div>
                    <div class="template-section">
                        <h4>Don't have a CSV file?</h4>
                        <button class="btn btn-secondary" id="downloadTemplate">
                            <i class="fas fa-download"></i> Download CSV Template
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Step 2: Participant List -->
        <div class="step" id="step2">
            <div class="step-header">
                <h2><span class="step-number">2</span> Review Participants & Assign Categories</h2>
            </div>
            <div class="step-content">
                <div class="participant-count">
                    <span id="participantCount">0 participants loaded</span>
                </div>
                
                <!-- Category Management -->
                <div class="category-section">
                    <h3>Certificate Categories</h3>
                    <div class="category-controls">
                        <div class="existing-categories">
                            <label for="categorySelect">Assign Category:</label>
                            <select id="categorySelect">
                                <option value="participation">Participation</option>
                                <option value="merit">Merit</option>
                                <option value="excellence">Excellence</option>
                                <option value="outstanding">Outstanding Performance</option>
                            </select>
                            <button class="btn btn-small btn-secondary" id="assignCategory">
                                <i class="fas fa-tag"></i> Assign to Selected
                            </button>
                        </div>
                        <div class="custom-category">
                            <input type="text" id="customCategoryInput" placeholder="Add new category...">
                            <button class="btn btn-small btn-primary" id="addCustomCategory">
                                <i class="fas fa-plus"></i> Add Category
                            </button>
                        </div>
                    </div>
                </div>

                <div class="participant-list" id="participantList">
                    <!-- Participants will be populated here -->
                </div>
                <div class="step-actions">
                    <button class="btn btn-secondary" id="backToStep1">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" id="proceedToTemplates">
                        Next: Choose Template <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 3: Template Selection -->
        <div class="step" id="step3">
            <div class="step-header">
                <h2><span class="step-number">3</span> Select Certificate Template</h2>
            </div>
            <div class="step-content">
                <div class="template-grid" id="templateGrid">
                    <!-- Templates will be populated here -->
                </div>
                <div class="step-actions">
                    <button class="btn btn-secondary" id="backToStep2">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" id="generateCertificates" disabled>
                        <i class="fas fa-magic"></i> Generate Certificates
                    </button>
                </div>
            </div>
        </div>

        <!-- Step 4: Download -->
        <div class="step" id="step4">
            <div class="step-header">
                <h2><span class="step-number">4</span> Download Certificates</h2>
            </div>
            <div class="step-content">
                <div class="generation-status">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <p id="statusText">Generating certificates...</p>
                </div>
                <div class="download-section" id="downloadSection" style="display: none;">
                    <div class="success-message">
                        <i class="fas fa-check-circle"></i>
                        <h3>Certificates Generated Successfully!</h3>
                        <p>All certificates have been generated and are ready for download.</p>
                    </div>
                    <button class="btn btn-primary btn-large" id="downloadAll">
                        <i class="fas fa-download"></i> Download All Certificates
                    </button>
                    <button class="btn btn-secondary" id="startOver">
                        <i class="fas fa-redo"></i> Generate More Certificates
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-step active" data-step="1">
            <div class="progress-circle">1</div>
            <span>Upload CSV</span>
        </div>
        <div class="progress-step" data-step="2">
            <div class="progress-circle">2</div>
            <span>Review</span>
        </div>
        <div class="progress-step" data-step="3">
            <div class="progress-circle">3</div>
            <span>Template</span>
        </div>
        <div class="progress-step" data-step="4">
            <div class="progress-circle">4</div>
            <span>Download</span>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        function scrollToGenerator() {
            document.getElementById('certificate-generator').scrollIntoView({
                behavior: 'smooth'
            });
        }
    </script>
</body>
</html>
